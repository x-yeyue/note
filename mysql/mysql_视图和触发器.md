# 视图

## 概述

**视图**是从数据库中的一张或多张中导出的表。
- 不占用空间，只是读取*基表*中的数据。
- 对视图中的数据进行修改时，相应基本表中的数据也会发生改变。
- 若基本表中数据发生改变，视图中的数据也会改变。

**基表**创建视图时所引用的表。

**优势**:
1. **简单** 
	- 视图中看到的即是需要的。
	- 用户不需要考虑对应的表结构、关联条件、筛选条件。
	- 对于用户来说，经常使用的查询可以被定义为视图。
2. **安全**
	- 视图可以作为一种*安全机制*。
	- 用户只能查看和修改他们所看到的数据。
3. **数据独立**
	- 视图可以使应用程序和数据表在一定程度上独立。
	- 创建视图后，应用程序可以建立在视图之上，从而使程序与数据表分割开来，就*可以屏蔽表结构变化带来的影响*。

## 创建视图

```sql
create [or replace] view view_name[(column_list)] as select_statement;
-- view_name: 视图的名称
-- column_list: 视图的字段列表
-- select_statement: select语句
```

**注**:
- 定义中引用的任何表或视图都必须存在。(在创建视图后，删除定义时应引用的表或视图，则使用视图时将导致错误)
- 创建视图不能引用临时表。
- `select` 语句中最大列名长度为 $64$ 个字符。
### 在单表上创建视图

```sql
-- 在学生表上创建一个湖北武汉籍学生的视图“湖北武汉学生”，包含学号、姓名、籍贯三列。
create view 湖北武汉学生 as SELECT 学号, 姓名, 籍贯 from 学生 where 籍贯 = '湖北武汉';

SELECT * from 湖北武汉学生;
```

### 在多表上创建

```sql
-- 在学生和选课表上建立一个按班级统计学生总成绩和平均成绩的视图“各班学生总成绩和平均成绩”，包含班级、总成绩和平均成绩三列。
create view 各班学生总成绩和平均成绩 as
SELECT 所在班级 as 班级, sum(成绩) as 总成绩, avg(成绩) as 平均成绩
FROM 学生 join 选课 on 学生.学号 = 选课.学号
group by 所在班级;

select * FROM 各班学生总成绩和平均成绩;
```

## 查看视图


```sql
-- 查看所有数据表(视图)
show tables;

-- 查看视图基本信息
DESC view_name;
describe view_name;

-- 查看视图定义语句
show create view view_name;
```

## 修改视图

